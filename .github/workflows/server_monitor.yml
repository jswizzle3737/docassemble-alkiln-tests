name: Server Health Monitor

# Monitor docassemble server health
on:
  schedule:
    # Run at 6:00 AM and 6:00 PM EST (10:00 and 22:00 UTC)
    - cron: "0 10,22 * * *"
  workflow_dispatch:  # Allow manual trigger

jobs:
  monitor-server:
    runs-on: ubuntu-latest
    name: Check Server Health
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Run Hall Monitor
        uses: SuffolkLITLab/ALActions/hall_monitor@main
        with:
          SERVER_URL: ${{ secrets.SERVER_URL }}
          # Optional: Add email notifications
          # SENDGRID_API_KEY: ${{ secrets.SENDGRID_API_KEY }}
          # ERROR_FROM_EMAIL: "Monitor <alert@example.com>"
          # ERROR_EMAILS: "admin@example.com"

      - name: Health Check Summary
        run: |
          echo "### Server Health Check :hospital:" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "All interviews checked successfully!" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Server:** ${{ secrets.SERVER_URL }}" >> $GITHUB_STEP_SUMMARY
          echo "**Time:** $(date)" >> $GITHUB_STEP_SUMMARY
