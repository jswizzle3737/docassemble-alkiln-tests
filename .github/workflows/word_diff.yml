name: Word Document Diff

# Review changes to Word documents in pull requests
on:
  pull_request:
    paths:
      - '**/*.docx'
  workflow_dispatch:

jobs:
  docx-review:
    runs-on: ubuntu-latest
    name: Diff Word Documents
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Need history for diff

      - name: Diff Word documents
        uses: SuffolkLITLab/ALActions/word_diff@main
        with:
          artifact_name: word-doc-diff
          output_dir: word_diffs
          summary_file: word_diff_summary.md

      - name: Comment on PR
        if: github.event_name == 'pull_request'
        run: |
          echo "### Word Document Changes :page_facing_up:" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "Check the artifacts for detailed diff of Word documents." >> $GITHUB_STEP_SUMMARY
